%--------------------------------------------------------------------------
% PAQUETES Y ESTILO 
%--------------------------------------------------------------------------
% Paquetes 
\usepackage[spanish]{babel}
%\usepackage[latin1]{inputenc}                      % Entrada de acentos
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[autostyle, spanish = mexican]{csquotes}% manejo de comillas: " "
\MakeOuterQuote{"}
\usepackage{pslatex}         
                     % Fuentes finas postscript
%\usepackage[sc]{mathpazo}                         % Fuentes mathpazo
%\usepackage[condensed,math]{kurier}
%\usepackage{palatino}
%\usepackage{librecaslon}
%\usepackage{rec-thy}

\usepackage{helvet}
\linespread{1.05}                                  % Fuente Palatino necesita espaciado
\usepackage[full]{textcomp}                        % Caracteres especiales como ' (recto)
\usepackage{xcolor}                                % Color: X11names (en el documentclass)

% COLORES personales---------------------------------------------------
    \definecolor{colortitulo}{RGB}{11,17,79} % Titulo
    \definecolor{colordominante}{RGB}{68,82,115} %Color del Cuadro grannde
    \definecolor{colordominanteF}{RGB}{219,68,14}
    \definecolor{colordominanteD}{RGB}{137,46,55}
    \definecolor{mostaza}{RGB}{231,196,25}
    \definecolor{amarilloM}{RGB}{248,199,90}
    \definecolor{amarilloD}{RGB}{251,237,121}
    \definecolor{azulF}{RGB}{66,74,86}
    \definecolor{grisD}{rgb}{.3,.3,.3}
    \definecolor{grisF}{rgb}{.6,.6,.6}
    \definecolor{grisamarillo}{RGB}{248,248,245} 
    \definecolor{miverde}{RGB}{44,162,67}
    \definecolor{verdep}{RGB}{94,142,118}
    \definecolor{verdencabezado}{RGB}{220,220,220} %Color de rect�ngulo de encabezado
    \definecolor{verdeF}{RGB}{5,92,8}
    \colorlet{mygray}{black!20}
    \newcommand{\verde}{\color{miverde}}
    
 
    
% Fin COLORES personales-------------------------------------------------

%---------------------------------------------------------------Colores 1
%\definecolor{colortitulo}{RGB}{219,68,14} %
%\definecolor{colordominante}{RGB}{243,102,25}
%\definecolor{colordominanteF}{RGB}{219,68,14}
%\definecolor{colordominanteD}{RGB}{137,46,55}
%\definecolor{mostaza}{RGB}{231,196,25}
%\definecolor{amarilloM}{RGB}{248,199,90}
%\definecolor{amarilloD}{RGB}{251,237,121}
%\definecolor{grisamarillo}{RGB}{248,248,245}
%\definecolor{miverde}{RGB}{44,162,67}
%\definecolor{verdep}{RGB}{94,142,118}
%\definecolor{verdencabezado}{RGB}{220,220,220} %Color de rect�ngulo de encabezado
%\definecolor{verdeF}{RGB}{5,92,8}
%\colorlet{mygray}{black!20}
%\definecolor{azulF}{rgb}{.0,.0,.3}
%\definecolor{grisD}{rgb}{.3,.3,.3}
%\definecolor{grisF}{rgb}{.6,.6,.6}
%\definecolor{miverde}{RGB}{44,162,67}
%\renewcommand{\verde}{\color{miverde}}
%---------------------------------------------------------------Colores 2



%\usepackage{psboxit}
\usepackage{pstricks}
\usepackage{xparse}
\usepackage{tcolorbox} 
\tcbuselibrary{skins,breakable}  % Librer�as tcolorbox
\usepackage{tikz,tkz-tab} % Cajas de Teoremas, ejemplos, etc.
\usetikzlibrary{positioning,shadows,backgrounds,calc}%
\usepackage{tikzpagenodes}
\usepackage{xargs}  % Comandos con opciones
\DeclareGraphicsExtensions{.pdf,.png,.jpg}
\usepackage{multicol}
% %\usepackage{epstopdf}% Conversi�n - Miktes 2.9 o inferior, TexLive 2009. o inferior
\usepackage[small,bf]{caption}
\usepackage[breaklinks,colorlinks=true, pdfstartview=FitV, linkcolor=azulF, citecolor=azulF, urlcolor=azulF]{hyperref}
\usepackage{exscale,amsmath,amssymb,amsfonts,latexsym,cancel,stmaryrd}
\usepackage[ruled,,vlined,lined,linesnumbered,algochapter]{algorithm2e}
\usepackage{framed}
\usepackage{titletoc}
\usepackage{calc}
\usepackage{colortbl} 
\usepackage{tabularx}
\usepackage{fancyvrb}
%\usepackage{minted}   %habilitar solo en Ubuntu (Linux)
\usepackage{array}
\usepackage{wasysym}
\usepackage{supertabular}
\usepackage{booktabs}
\usepackage[shortlabels]{enumitem}
%\usepackage{mathrsfs}
\usepackage{calrsfs}
\usepackage{wrapfig}%Figuras al lado de texto
\usepackage[lflt]{floatflt} %Figuras flotantes entre el texto
\usepackage{parskip} %Quita la sangría al iniciar los párrafos



%----------------------------------------------------------------------------------------
% Fuentes
%----------------------------------------------------------------------------------------
% Comandos para fuentes especiales
\newcommandx*{\fnte}[4][1=pag,2=9,3=n]{{\color{azulF}\fontfamily{#1}
\fontsize{#2}{1}\fontshape{#3}\selectfont{#4}}}

\newcommandx*{\fntb}[4][1=pag,2=9,3=n]{{\color{azulF}\fontfamily{#1}\fontsize{#2}{1}\fontseries{b}\fontshape{#3}\selectfont{#4}}}

\newcommandx*{\fntg}[4][1=pag,2=9,3=n]{{\color{grisF}\fontfamily{#1}\fontsize{#2}{1}\fontshape{#3}\selectfont{#4}}}

\newcommand{\fhv}[2]{{\fontfamily{pag}\fontsize{#1}{1}\selectfont{#2}}}

\newcommand{\fhvb}[2]{{\textcolor[RGB]{68,82,115}{\fontfamily{pag}\fontseries{b}\fontsize{#1}{1}\selectfont{#2}}}}
% Fin fuentes----------------------------------------------------------

%*************************************** DISEÑO *****************************************

%----------------------------------------------------------------------------------------
% Cabeceras
%----------------------------------------------------------------------------------------
\usepackage{fancyhdr}

% N�meros de p�gina en rect�ngulos y cap�tulo. 
\usepackage[absolute]{textpos}
    \setlength{\TPHorizModule}{10mm}% 1 generic horizontal unit is equivalent to 10mm
    \setlength{\TPVertModule}{10mm}% 1 generic vertical unit is equivalent to 10mm
    \textblockorigin{0mm}{0mm}% top left corner set as origin

%------------------------------------------------------------------------------
% Decoraci�n de cabeceras 
% Texto en secciones
\newcommand{\helvb}{%
\fontfamily{phv}\fontseries{b}\fontsize{9}{11}\selectfont}
\newcommand{\helv}{%
\fontfamily{phv}\fontsize{9}{11}\selectfont}
\renewcommand{\sectionmark}[1]{\markright{\thesection\hspace{5pt}#1}{}} 
% Configuraci�n de fuentes para el n�mero de p�gina en el encabezado
\fancyhf{} 
%OP 1: Todas las p�ginas con la secci�n a la izquierda
%\fancyhead[LO,LE]{\rightmark} % L=Left, O=Odd y  E=Even pages
%OP 2: Todas las p�ginas con la secci�n a la izquierda en un rect�ngulo (todo el header)

%Rect�ngulo en el encabezado
\fancyhead[LO,LE]{\helv\rightmark
\begin{textblock}{1}(0,0)
\begin{tikzpicture}[remember picture,overlay]
  %\fill[grisamarillo] (current page.north west) 
  \fill[verdencabezado,opacity=50] (current page.north west) %color del encabezado
  rectangle
  ([xshift=2pt,yshift=-3pt]current page.east|-current page header area.south east);
\end{tikzpicture}
\end{textblock}
}
% Fin decoraci�n cabeceras

\renewcommand{\headrulewidth}{0pt}   % Ancho de la l�nea bajo el encabezado
\addtolength{\headheight}{2.5pt}     % Aumente el espacio alrededor de la cabecera 
\renewcommand{\footrulewidth}{0pt}   % Elimina la l�nea en el pie de p�gina
% Estilo para cuando se especifica "pagestyle plain"
\fancypagestyle{plain}{\fancyhead{}\renewcommand{\headrulewidth}{0pt}} 

% Elimina el encabezado de las p�ginas impares vac�as al final de los cap�tulos
\makeatletter
\renewcommand{\cleardoublepage}{
\clearpage\ifodd\c@page\else
\hbox{}
\vspace*{\fill}
\thispagestyle{empty}
\newpage
\fi}
\makeatother

% N�meros de p�gina en el borde
\fancyfoot[LO]{
\begin{textblock}{3}(21,1) % y=1 inch = margen
\begin{tikzpicture}[overlay]
\node[draw=colordominante,
rectangle,minimum width=2cm, minimum height=2cm,
anchor=west,
fill=colordominante,font=\fontsize{25}{1}\sffamily\bfseries,inner sep=2pt,outer sep=2pt] 
at (-1.5cm,0pt){\textcolor{gray!10}{\thepage}};
\end{tikzpicture}
\end{textblock}
}

\fancyfoot[RE]{
\begin{textblock}{3}(18,1)% y=1 inch = margen
\begin{tikzpicture}[overlay]
\node[draw=colordominante,
rectangle,minimum width=2cm, minimum height=2cm,
anchor=west,
fill=colordominante,font=\fontsize{25}{1}\sffamily\bfseries,inner sep=2pt,outer sep=2pt] 
at (-1.5cm,0pt){\textcolor{gray!10}{\thepage}};   
\end{tikzpicture}
\end{textblock}
}
%-- Fin cabeceras 

%----------------------------------------------------------------------------------------
% Color en los m�rgenes
%----------------------------------------------------------------------------------------
% \pagecolor{grisamarillo}
% \usepackage{eso-pic}
% \pagecolor{grisamarillo}
% \AddToShipoutPictureBG{%
%  \AtTextLowerLeft{\color{grisamarillo}%
%   \rule[-\footskip]{\textwidth}{\dimexpr\textheight+\footskip}}}

% Fin color m�rgenes



%----------------------------------------------------------------------------------------
% Pr�logo
%----------------------------------------------------------------------------------------
\NewDocumentEnvironment{prologo}{O{}}{%
\addcontentsline{toc}{schapter}{%
\hspace{6em}{\color{azulF}{\fontfamily{phv}\fontsize{9}{10}\selectfont Pr\'ologo}} \qquad}
\chapter*{Pr�logo}
\smallskip\smallskip
\begin{minipage}{0.9\textwidth}
 #1}{\end{minipage}}
 

%----------------------------------------------------------------------------------------
% T�tulo (PORTADA)
%----------------------------------------------------------------------------------------


\newcommand*{\titulo}[4]{\begingroup%
\raggedleft 
\vspace*{\baselineskip} % Espacio en blanco en la parte superior de la p�gina
\renewcommand{\headrulewidth}{2pt}

\thispagestyle{empty}

\begin{minipage}[c][0.15\textheight][c]{0.2\textwidth}
	\begin{center}
		\includegraphics[width=2cm, height=2cm]{images/logoF.jpeg}
	\end{center}
\end{minipage}
\begin{minipage}[c][0.15\textheight][t]{0.75\textwidth}
	\begin{center}
		\vspace{.9cm}
		{\scshape \bf \Large \color{azulF}Universidad Nacional Aut\'onoma de M\'exico}
		\vspace{.3cm}
		\textcolor[RGB]{191,191,191}{\hrule height2.5pt}
		\vspace{1.5mm}
		\textcolor[RGB]{191,191,191}{\hrule height1pt}
		\vspace{.3cm}
		{\scshape \Large \color{azulF} Facultad de Ingeniería}
	\end{center}
\end{minipage}

\begin{minipage}[c][0.6\textheight][t]{0.1\textwidth}
	\begin{center}
		\hskip -1.5cm 
		\textcolor[RGB]{191,191,191}{\vrule width2pt height16cm}
		\hskip1.5mm
		\textcolor[RGB]{191,191,191}{\vrule width4pt height16cm}
		\hskip1.5mm
		\textcolor[RGB]{191,191,191}{\vrule width2pt height16cm} \\
		%\includegraphics[height=3cm]{images/logoF.jpeg}
	\end{center}
\end{minipage}
\begin{minipage}[c][0.6\textheight][t]{0.75\textwidth}
	\begin{center}
		
		\vspace{45pt} 
		
		{\Large \scshape {\Huge #1}}
		\vspace{2.5cm}
	    
	    \makebox[5cm][c]{\Huge \color{azulF}T\hspace{1.3cm}E\hspace{1.3cm}S\hspace{1.3cm}I\hspace{1.3cm}S}  \\[8pt]
	    \color{azulF}{QUE PARA OBTENER EL T\'iTULO DE:}\\[5pt]
	    {\large \color{azulF} \textbf{{MATEM\'ATICO}}}\\[40pt]            
	    \color{azulF}{PRESENTA:}\\[5pt]
	    {\color{azulF} \textbf{{\Huge \bfseries #2}}}
	    
	    \vspace{50pt}
	    
	    {\small\color{azulF}{DIRECTOR DEL TRABAJO:}\\ {\textcolor{colordominante}{\Large #3}}}
	    
	    \vspace{45pt}
	    
	    {\Large \textit{#4}}\par
			
			
			
	\end{center}
\end{minipage}
	

%	{\Huge #1} \\[\baselineskip] %0.1\textheight] % T�tulo
%	{\Huge \bfseries #2}\\[\baselineskip] % Autor
%	{\textcolor{colordominante}{\Large #3}}\\[\baselineskip] % Doc
%	{\Large \textit{#4}}\par % Descripci�n adicional


\vfill % Espacio en blanco entre el bloque de t�tulo y "la editorial"

%{\raggedright
%\begin{minipage}[c]{0.08\textwidth}
%\raisebox{-2.0cm}{\includegraphics[width=1.4cm]{images/logo}}
 %\end{minipage}
\  \ \hfill %\begin{minipage}[t]{0.9\textwidth}
%{\color{gray}
 %\fhv{9}{Revista digital}\\
 \ %fhvb{9}{\color{azulF}Matem�tica, Educaci�n e Internet.}
  %\fntg[pag][8]{\color{grisF}
  %\href{http://www.tec-digital.itcr.ac.cr/revistamatematica/}{(http://www.tec-digital.itcr.ac.cr/revistamatematica/).}}}
%\end{minipage}          
%}%raggedright
\vspace*{3\baselineskip} % Espacio en blanco antes del final de p�gina
\endgroup}
% Fin Titulo--------------------------------------------------------





%-------------------CONTENIDO -----------------------------------------------------
\definecolor{mycolorA}{RGB}{222,122,138}  % Color de los n�meros grandes en el �ndice 
\definecolor{mycolorB}{RGB}{192,192,192} % 

% patching of \tableofcontents to use sans serif font for the tile
\patchcmd{\tableofcontents}{\contentsname}{\contentsname}{}{}
% patching of \@part to typeset the part number inside a framed box in its own line
% and to add color
\makeatletter
\patchcmd{\@part}
  {\addcontentsline{toc}{part}{\thepart\hspace{1em}#1}}
  {\addtocontents{toc}{\protect\addvspace{20pt}}
    \addcontentsline{toc}{part}{\huge{\protect\color{colordominante}%
      \setlength\fboxrule{2pt}\protect\Circle{%
        \hfil\thepart\hfil%
      }%
    }\\[2ex]\color{colordominante}\sffamily\large#1}}{}{}
\makeatother

% this is the environment used to typeset the chapter entries in the ToC
% it is a modification of the leftbar environment of the framed package
\renewenvironment{leftbar}
  {\def\FrameCommand{\hspace{6em}%
    {\color{mycolorB}\vrule width 2pt depth 6pt}\hspace{1em}}%
    \MakeFramed{\parshape 1 0cm \dimexpr\textwidth-6em\relax\FrameRestore}\vskip2pt%
  }
 {\endMakeFramed}

% using titletoc we redefine the ToC entries for parts, chapters, sections, and subsections
\titlecontents{part}
  [0em]{\centering}
  {\contentslabel}
  {}{}
\titlecontents{chapter}
  [0em]{\vspace*{2\baselineskip}}
  {\parbox{4.5em}{%
    \hfill\Huge\bfseries\color{mycolorA}\thecontentspage}%
   \vspace*{-2.3\baselineskip}\leftbar{\fhvb{12}{\chaptername~\thecontentslabel}}\\}
  {}{\endleftbar}
\titlecontents{section}
  [8.4em]
  {\sffamily\contentslabel{3em}}{}{}
  {\hspace{0.5em}\nobreak\itshape\color{mycolorA}\contentspage}
\titlecontents{subsection}
  [8.4em]
  {\sffamily\contentslabel{3em}}{}{}  
  {\hspace{0.5em}\nobreak\itshape\color{mycolorA}\contentspage}

% Fin Contenido 

%----------------------------------------------------------------------------------------
% CAPITULO Estilo simple (Donde est� la raya vertical junto al n�mero Gigante)
%----------------------------------------------------------------------------------------
 \usepackage{titlesec, blindtext, color}
 \newcommand{\hsp}{\hspace{20pt}}
 \titleformat{\chapter}[hang]{\huge\bfseries\color{colordominante}}{{
         \fontsize{5em}{5em}\selectfont\color{colordominante}
         \thechapter}\hsp\textcolor[RGB]{191,191,191}{\vrule height 4em width 2pt}\hsp}{0pt}{\huge\bfseries\color{colordominante}}
    

%----------------------------------------------------------------------------------------
%	Numeraci�n de las secciones -- en el margen
%----------------------------------------------------------------------------------------

\makeatletter
\renewcommand{\@seccntformat}[1]{\llap{\textcolor{colordominante}{\csname the#1\endcsname}\hspace{1em}}}                    
\renewcommand{\section}{\@startsection{section}{1}{\z@}
{-4ex \@plus -1ex \@minus -.4ex}
{1ex \@plus.2ex }
{\normalfont\large\sffamily\bfseries}}
\renewcommand{\subsection}{\@startsection {subsection}{2}{\z@}
{-3ex \@plus -0.1ex \@minus -.4ex}
{0.5ex \@plus.2ex }
{\normalfont\sffamily\bfseries}}
\renewcommand{\subsubsection}{\@startsection {subsubsection}{3}{\z@}
{-2ex \@plus -0.1ex \@minus -.2ex}
{0.2ex \@plus.2ex }
{\normalfont\small\sffamily\bfseries}}                        
\renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}
{-2ex \@plus-.2ex \@minus .2ex}
{0.1ex}
{\normalfont\small\sffamily\bfseries}}
\makeatother
% Fin numeraci�n secciones



%---------------------------------------------------------------------------------
%  Entornos:  Ejemplo, teorema, proposici�n, lema, lista de ejercicios, 
%             caja interludio, caja simple  
%---------------------------------------------------------------------------------

%  Cajas con el paquete  tcbcolor
%  CONTADORES: ejemplo, definicion, lema, teorema, corolario, proposicion,ejercicio 
\newcounter{tcbteo}[chapter]
\renewcommand{\thetcbteo}{\thechapter.\arabic{tcbteo}}

\newcounter{tcbdefi}[chapter]
\renewcommand{\thetcbdefi}{\thechapter.\arabic{tcbdefi}}

\newcounter{tcblema}[chapter]
\renewcommand{\thetcblema}{\thechapter.\arabic{tcblema}}

\newcounter{tcbcoro}[chapter]
\renewcommand{\thetcbcoro}{\thechapter.\arabic{tcbcoro}}

\newcounter{tcbvoca}[chapter]
\renewcommand{\thetcbvoca}{\thechapter.\arabic{tcbvoca}}

%  \newcounter{tcbListaEjercicios}[chapter]
%  \renewcommand{\thetcbListaEjercicios}{\thechapter.\arabic{tcbListaEjercicios}}

\newcounter{tcbpropo}[chapter]
\renewcommand{\thetcbpropo}{\thechapter.\arabic{tcbpropo}}

\newlength{\examlen}
\tikzset{
    wnodeTeorema/.style={%
         rectangle,  top color=gray!5, bottom color=gray!5,
         inner sep=1mm,anchor=west,font=\small\bf\sffamily},
   wnodeminimo/.style={%
         rectangle,  top color=white, bottom color=white,
         text=azulF,inner sep=1mm,anchor=west,font=\small\bf\sffamily}      
}



%\begin{teorema}  o \begin{teorema}[de tal] o \begin{teorema}[][ref]
% Teorema -----------------------------------------------------
\newtcolorbox{wwteorema}[3][]{%
arc=0mm,breakable,enhanced,colback=gray!2,boxrule=0pt,top=7mm,
fontupper=\normalsize,step and label={tcbteo}{#3},
overlay unbroken = {\draw[color=colordominante,line width=0.2pt] (frame.north west)--([xshift=0pt]frame.north east);
%Caja de T�tulo: teo --
\node[wnodeTeorema](tituloteo) at ([xshift=0pt, yshift=-4mm]frame.north west)
{\textbf{\color{colordominante} Teorema \thetcbteo \;#2}};
%Borde superior --
\draw[colordominante,line width=2.5cm] ([xshift=1.25cm, yshift=0cm]frame.north west)-- +(\examlen,3pt);
},%
overlay first = {\draw[color=colordominante,line width=0.2pt] (frame.north west)--([xshift=0pt]frame.north east);
%Caja de T�tulo: teo --
\node[wnodeTeorema](tituloteo) at ([xshift=0pt, yshift=-4mm]frame.north west)
{\textbf{\color{colordominante} Teorema \thetcbteo \;#2}};
%Borde superior --
\draw[colordominante,line width=2.5cm] ([xshift=1.25cm, yshift=0cm]frame.north west)-- +(\examlen,3pt);
},%
% Mantener borde en cambio de p�gina 
overlay last = {\draw[color=colordominante,line width=0.2pt] (frame.north west)--([xshift=0pt]frame.north east);
                } 
#1}
%-
\NewDocumentEnvironment{teorema}{O{} O{} O{}}{\smallskip\begin{wwteorema}{#1}{#2}%
 #3}{\end{wwteorema}\smallskip }
% TEOREMA---------------------------------------------------------



%\begin{proposicion}  o \begin{proposicion}[de tal] o \begin{proposicion}[][ref]
% Proposici�n-----------------------------------------------------
\newtcolorbox{wwpropo}[3][]{%
arc=0mm,breakable,enhanced,colback=gray!2,boxrule=0pt,top=7mm,
fontupper=\normalsize,step and label={tcbpropo}{#3},
overlay unbroken ={\draw[color=colordominante,line width=0.2pt] (frame.north west)--([xshift=0pt]frame.north east);
%Caja de T�tulo: propo --
\node[wnodeTeorema](tituloteo) at ([xshift=0pt, yshift=-4mm]frame.north west)
{\textbf{\color{colordominante} Proposici\'on \thetcbpropo\;#2}};
%Borde superior --
\draw[colordominante,line width=2.5cm] ([xshift=1.25cm, yshift=0cm]frame.north west)-- +(\examlen,3pt);
}, %
overlay first ={\draw[color=colordominante,line width=0.2pt] (frame.north west)--([xshift=0pt]frame.north east);
%Caja de T�tulo: propo --
\node[wnodeTeorema](tituloteo) at ([xshift=0pt, yshift=-4mm]frame.north west)
{\textbf{\color{colordominante} Proposici\'on \thetcbpropo\;#2}};
%Borde superior --
\draw[colordominante,line width=2.5cm] ([xshift=1.25cm, yshift=0cm]frame.north west)-- +(\examlen,3pt);
}, %
% Mantener borde en cambio de p�gina 
overlay last ={\draw[color=colordominante,line width=0.2pt] (frame.north west)--([xshift=0pt]frame.north east);
        },
#1}
%-
\NewDocumentEnvironment{proposicion}{O{} O{} O{}}{\smallskip\begin{wwpropo}{#1}{#2}%
 #3}{\end{wwpropo}\smallskip }
% ---------------------------------------------------------



% LEMA -----------------------------------------------------------
 \newtcolorbox{wwlema}[3][]{%
arc=0mm,breakable,enhanced,colback=gray!2,boxrule=0pt,
top=1mm, left=3pt,
step and label={tcblema}{#3},
fontupper={\small\bf\sffamily {\color{azulF}Lema \thetcblema \;#2}}~\normalfont, %"Lema..."+texto del cuerpo
overlay unbroken  = {%barra vertical
\draw[color=gray,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);                
         },%
overlay first  = {%barra vertical
\draw[color=gray,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);                
         },%
% Mantener borde en cambio de p�gina     
overlay last ={\draw[color=gray,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);   },    
#1}
%-
\NewDocumentEnvironment{lema}{O{} O{} O{}}{\smallskip\begin{wwlema}{#1}{#2}%
#3}{\end{wwlema}\smallskip }
%LEMA--------------------------------------------------------------


% % Corolario -------------------------------------------------------
\newtcolorbox{wwcoro}[2][]{%
arc=0mm,breakable,enhanced,colback=gray!2,boxrule=0pt,
top=1mm,left=3pt,
fontupper={\small\bf\sffamily {\color{azulF}Corolario \thetcbcoro}\;}~\normalfont, 
step and label={tcbcoro}{#2},
overlay unbroken  = {%barra vertical
\draw[color=gray,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);                
        },%
overlay first  = {%barra vertical
\draw[color=gray,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);                
        },%
% Mantener borde en cambio de p�gina     
overlay last ={\draw[color=gray,line width=3pt] 
                     ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);
              }     
#1}
%-
\NewDocumentEnvironment{corolario}{O{} O{}}{\smallskip\begin{wwcoro}{#1}%
}{\end{wwcoro}\smallskip }
% Corolario------------------------------------------------------


% % Definici�n---------------------------------------------------
\newtcolorbox{wwdefinicion}[3][]{%
arc=0mm,breakable,enhanced,colback=gray!2,boxrule=0pt, %cambia el fondo de la caja
top=6mm,fontupper=\normalsize,step and label={tcbdefi}{#3},
overlay unbroken  = {
%barra vertical
\draw[color=colordominante,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);         
%Caja de T�tulo: defi --
\node[wnodeTeorema](titulodefi) at ([xshift=4.5pt, yshift=-3mm]frame.north west)
{\textbf{\color{colordominante} Definici\'on \thetcbdefi \;#2}};
                }, %overlay
overlay first  = {
%barra vertical
\draw[color=colordominante,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);         
%Caja de T�tulo: defi --
\node[wnodeTeorema](titulodefi) at ([xshift=4.5pt, yshift=-3mm]frame.north west)
{\textbf{Definici�n \thetcbdefi \;#2}};
                }, %overlay
% Mantener borde en cambio de p�gina
overlay last    = {%barra vertical
\draw[color=colordominante,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);}
#1}
%-
\NewDocumentEnvironment{definicion}{O{} O{} O{}}{\smallskip\begin{wwdefinicion}{#1}{#2}%
 #3}{\end{wwdefinicion}\smallskip }
% %DEFINICION---------------------------------------------------------


% Caja para Ejemplo --------------------------------------------------
\newcounter{tcbejem}[chapter]
\renewcommand{\thetcbejem}{\thechapter.\arabic{tcbejem}}
\colorlet{colorfondoejemplo}{gray!2}
\definecolor{colorejemplo}{rgb}{.0,.0,.3}
% Ejemplo
\newtcolorbox{wwejemplo}[3][]{%
arc=0mm,
breakable,drop fuzzy shadow,
enhanced,
colback=gray!2,
boxrule=0pt,
top=8mm, %Separaci�n vertical - inicia texto
enlarge top by=\baselineskip/2+1mm,
enlarge top at break by=0mm,pad at break=2mm,
fontupper=\normalsize,
step and label={tcbejem}{#3},
overlay unbroken  = {%
%barra vertical
\draw[color=colordominante,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);           
% Caja de imagen Ejemplo
\node[rectangle, 
         text=gray!2, 
         inner sep=1mm,anchor=west,font=\small\bf\sffamily] at ([xshift=-14.3pt,yshift=-4.1mm]frame.north west)%
{\includegraphics{images/nodoejemplo}\raisebox{0.5cm}{}};
% Caja numeraci�n y descripci�n
\node[rectangle, 
 text=gray!2, 
 inner sep=1mm,
 anchor=west,
 font=\normalsize] at ([xshift=1.1cm,yshift=-2.9mm]frame.north west)%
 {\fhvb{10}{\;\thetcbejem \;\;\;#2}};
     }, % overlay
overlay first  = {%
%barra vertical
\draw[color=colordominante	,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);           
% Caja de imagen Ejemplo
\node[rectangle, 
         text=gray!2, 
         inner sep=1mm,anchor=west,font=\small\bf\sffamily] at ([xshift=-14.3pt,yshift=-4.1mm]frame.north west)%
{\includegraphics{images/nodoejemplo}\raisebox{0.5cm}{}};
% Caja numeraci�n y descripci�n
\node[rectangle, 
 text=gray!2, 
 inner sep=1mm,
 anchor=west,
 font=\normalsize] at ([xshift=1.1cm,yshift=-2.9mm]frame.north west)%
 {\fhvb{10}{\;\thetcbejem \;\;\;#2}};
     }, % overlay
%Borde cambio de p�ginas
overlay middle={\draw[color=grisamarillo,line width=3pt] ([xshift=3pt] frame.north west)--([xshift=2pt] frame.south west);},
overlay last={\draw[color=grisamarillo,line width=3pt] ([xshift=3pt] frame.north west)--([xshift=2pt] frame.south west);}
#1}
%-
\NewDocumentEnvironment{ejemplo}{O{} O{} O{}}{\smallskip\begin{wwejemplo}{#1}{#2}%
 #3}{\end{wwejemplo}\smallskip }
%EJEMPLO-----------------------------------------------------------------



% CAJA (interludio, comentario...)---------------------------------------
\definecolor{colrnodocaja}{RGB}{73,111,80}
\definecolor{colrfondocaja}{RGB}{210,218,233}

%\definecolor{colrnodocaja}{RGB}{44,91,144}
%\definecolor{colrfondocaja}{RGB}{241,241,227}


\newtcolorbox{wwcaja}[2][]{%
arc=0mm,breakable,%drop fuzzy shadow,
enhanced,colback=gray!4,
boxrule=0pt,
top=3mm, %Separaci�n vertical - inicia texto
enlarge top by=\baselineskip/2+1mm,
enlarge top at break by=0mm,pad at break=2mm,
fontupper=\normalsize,
%step and label={tcbca}{#3},
%Borde
overlay unbroken={\draw[color=gray!2,line width=0.2pt] (frame.north west)
  --([xshift=0pt]frame.north east)
  --([xshift=0pt]frame.south east)
  --([xshift=0pt]frame.south west)--(frame.north west);
% Caja de T�tulo CAJA
\node[ rectangle, %minimum width=0cm, minimum height=0.0cm,
         top color=amarilloD, bottom color=amarilloD,
         inner sep=0.5mm,anchor=west,font=\normalsize]at ([xshift=-0.5pt,  yshift=2.30mm]frame.north west){\fhvb{10}{ #2}};
         },
%Borde
overlay first={\draw[color=gray!2,line width=0.2pt] (frame.north west)
  --([xshift=0pt]frame.north east)
  --([xshift=0pt]frame.south east)
  --([xshift=0pt]frame.south west)--(frame.north west);
% Caja de T�tulo CAJA
\node[ rectangle, %minimum width=0cm, minimum height=0.0cm,
         top color=amarilloD, bottom color=amarilloD,
         inner sep=0.5mm,anchor=west,font=\normalsize]at ([xshift=-0.5pt,  yshift=2.30mm]frame.north west){\fhvb{10}{ #2}};
         },
%Borde cambio de p�gina
overlay last={\draw[color=gray!2,line width=0.2pt] (frame.north west)
  --([xshift=0pt]frame.north east)
  --([xshift=0pt]frame.south east)
  --([xshift=0pt]frame.south west)--(frame.north west);}
#1}
%-
\NewDocumentEnvironment{caja}{O{} O{}}{\smallskip\begin{wwcaja}{#1}%
 #2}{\end{wwcaja}\smallskip }
% CAJA de comentario


%CAJA simple---------------------------------------------------------------------
\newtcolorbox{wwbox}[1][]{%
arc=0mm,breakable,drop fuzzy shadow,
enhanced,colback=grisamarillo,
boxrule=0pt,
top=3mm, %Separaci�n vertical - inicia texto
enlarge top by=\baselineskip/2+1mm,
enlarge top at break by=0mm,pad at break=2mm,
fontupper=\normalsize,
%step and label={tcbca}{#3},
%Borde
overlay unbroken={\draw[color=amarilloD,line width=0.5pt] (frame.north west)
  --([xshift=0pt]frame.north east)
  --([xshift=0pt]frame.south east)
  --([xshift=0pt]frame.south west)--(frame.north west);
        },
%Borde
overlay first={\draw[color=amarilloD,line width=0.5pt] (frame.north west)
  --([xshift=0pt]frame.north east)
  --([xshift=0pt]frame.south east)
  --([xshift=0pt]frame.south west)--(frame.north west);
        },
%Borde cambio de p�gina
overlay last={\draw[color=amarilloD,line width=0.5pt] (frame.north west)
  --([xshift=0pt]frame.north east)
  --([xshift=0pt]frame.south east)
  --([xshift=0pt]frame.south west)--(frame.north west);}
#1}

 \newenvironment{scaja}[1][]{\bigskip\begin{wwbox}%
 #1}{\end{wwbox}}	
% Fin CAJA simple

%CAJA vocabulario-------------------------------------------------------
\newtcolorbox{vocabox}[3][]{%
arc=0mm,breakable,enhanced,colback=white,boxrule=0pt,
top=1mm, left=3pt,
step and label={tcbvoca}{#3},
fontupper={\small\bf\sffamily {\color{azulF}Vocabulario \thetcbvoca \;#2}}~\normalfont, %"Vocabulario..."+texto del cuerpo
overlay first  = {%barra vertical
\draw[color=white,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);                
         },%
overlay first  = {%barra vertical
\draw[color=white,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);                
         },%
% Mantener borde en cambio de p�gina     
overlay last ={\draw[color=white,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);   },    
#1}
%-
\NewDocumentEnvironment{vocabulario}{O{} O{} O{}}{\smallskip\begin{vocabox}{#1}{#2}%
#3}{\end{vocabox}\smallskip }	
% Fin vocabulario

%CAJA nota-------------------------------------------------------
\newtcolorbox{notabox}[1][]{%
arc=0mm,breakable,
enhanced,colback=white,
boxrule=0pt,
top=3mm, %Separaci�n vertical - inicia texto
left=25pt,
enlarge top by=\baselineskip/2+1mm,
enlarge top at break by=0mm,pad at break=2mm,
fontupper={\begin{tikzpicture}[overlay]
\node[draw=colordominanteF,line width=1pt,circle,fill=white,font=\sffamily\bfseries,inner sep=2pt,outer sep=0pt] at (-15pt,3pt){\textcolor{colordominanteF}{N}};\end{tikzpicture}}~\normalfont,  %"NOTA..."+texto del cuerpo
%Borde y c�rculo
overlay first={
\draw[color=white,line width=0.5pt] (frame.north west)
  --([xshift=0pt]frame.north east)
  --([xshift=0pt]frame.south east)
  --([xshift=0pt]frame.south west)--(frame.north west);
        },
%Borde y c�rculo
overlay first={
\draw[color=white,line width=0.5pt] (frame.north west)
  --([xshift=0pt]frame.north east)
  --([xshift=0pt]frame.south east)
  --([xshift=0pt]frame.south west)--(frame.north west);
        },
%Borde cambio de p�gina
overlay last={\draw[color=white,line width=0.5pt] (frame.north west)
  --([xshift=0pt]frame.north east)
  --([xshift=0pt]frame.south east)
  --([xshift=0pt]frame.south west)--(frame.north west);}
#1}
%-
 \newenvironment{nota}[1][]{\bigskip\begin{notabox}%
 #1}{\end{notabox}}	
% Fin nota


%--------------------------------------------------------------------------------
% LISTAS DE EJERCICIOS
%--------------------------------------------------------------------------------
 
\usepackage{answers}
\newtheorem{exer}{}[chapter]
\newenvironment{ejer}{\begin{exer}\normalfont}{\end{exer}}
\Newassociation{solu}{Soln}{ans}

% USO del entorno personalizado---------------------------------------------------
%\begin{ejercicios} --- \end{ejercicios} para listas simples
%\begin{cejercicios} --- \end{cejercicios} para listas en cajas

\NewDocumentEnvironment{ejercicios}{O{}}{%
\bigskip\begin{minipage}{\textwidth}{\bf\verde Ejercicios}
                                     #1}{\end{minipage}\bigskip}



\colorlet{color1}{gray!5!white}       % color fondo
\definecolor{color2}{RGB}{117,184,68} % color del nodo
% Caja -- ejercicios
\newtcolorbox{wwlistaejercicios}[1][]{%
  arc=0mm,breakable,enhanced,colback=color1,boxrule=0pt,top=8mm, 
  enlarge top by=\baselineskip/2+1mm, enlarge top at break by=0mm,
  pad at break=2mm,fontupper=\normalsize,
  overlay unbroken={ % nodo rectangular  para "Ejercicios"
  \node[rectangle, minimum width=4cm, 
      top color=color2, bottom color=color2, 
      inner sep=1mm,anchor=west,font=\normalsize] 
   at ([xshift=0pt,yshift=-3mm]frame.north west)%
{\textbf{Ejercicios}};},
  overlay first={ % nodo rectangular  para "Ejercicios"
  \node[rectangle, minimum width=4cm, 
      top color=color2, bottom color=color2, 
      inner sep=1mm,anchor=west,font=\normalsize] 
   at ([xshift=0pt,yshift=-3mm]frame.north west)%
{\textbf{Ejercicios}};},
overlay last ={ } % cambio de p�gina, solo caja gris
#1}

% Nuevo entorno personalizado----------------------------------------
\NewDocumentEnvironment{cejercicios}{O{}}{%
\bigskip\begin{wwlistaejercicios}%
 #1}{\end{wwlistaejercicios}\bigskip } % 
% -------------------------------------------------------------------

% Ejercicio - Caja para ejercicio solitario
\newtcolorbox{wwejercicio}[1][]{%
arc=0mm,breakable,enhanced,colback=gray!5,boxrule=0pt,
top=1mm,left=3pt,
fontupper={\bf\sffamily {\color{miverde}Ejercicio.}\;}~\normalfont, 
overlay unbroken  = {%barra vertical
\draw[color=gray,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);               
        },%
overlay first  = {%barra vertical
\draw[color=gray,line width=3pt] ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);               
        },%
% Mantener borde en cambio de p�gina     
overlay last ={\draw[color=gray,line width=3pt] 
                     ([xshift=2pt] frame.north west)--([xshift=2pt] frame.south west);
              }     
#1}


% Entorno con Caja para ejercicios-----------------------------------------
%\begin{cajaejercicios}  o \begin{cajaejercicios}[de tal] 
%                        o \begin{cajaejercicios}[][ref]
% Entorno personalizado---------------------------------------------------
\definecolor{colorejercicios}{RGB}{99,42,134}
\newcounter{tcbejer}[chapter]
\renewcommand{\thetcbejer}{\thechapter.\arabic{tcbejer}}

\newtcolorbox{wwejercicios}[3][]{%
arc=0mm,breakable,%drop fuzzy shadow,
enhanced,colback=gray!5,boxrule=0pt,top=7mm,
fontupper=\normalsize,step and label={tcbejer}{#3},
overlay unbroken = {
%Borde grueso superior
\draw[color=colorejercicios,line width=3pt] (frame.north west)--([xshift=0pt]frame.north east);
%Caja de T�tulo: Ejer --
\node[rounded corners=3pt,  draw=colorejercicios, top color=white, bottom color=white, thick,inner sep=1mm,anchor=west, font=\small\bf\sffamily](tituloejer) at ([xshift=5mm, yshift=0mm]frame.north west)
{\textbf{\color{miverde}  Ejercicios \thetcbejer \;#2}};
%borde l�nea inferior
 \draw[color=colorejercicios,line width=0.2pt] (frame.south west)--([xshift=0pt]frame.south east); 
},%overlay
overlay first = {
%Borde grueso superior
\draw[color=colorejercicios,line width=3pt] (frame.north west)--([xshift=0pt]frame.north east);
%Caja de T�tulo: Ejer --
\node[rounded corners=3pt,  draw=colorejercicios, top color=white, bottom color=white, thick,inner sep=1mm,anchor=west, font=\small\bf\sffamily](tituloejer) at ([xshift=5mm, yshift=0mm]frame.north west)
{\textbf{\color{miverde}  Ejercicios \thetcbejer \;#2}};
%borde l�nea inferior
 \draw[color=colorejercicios,line width=0.2pt] (frame.south west)--([xshift=0pt]frame.south east); 
},%overlay
% % Mantener borde en cambio de p�gina 
% overlay middle = {\draw[color=colordominante,line width=0.2pt] (frame.north west)--([xshift=0pt]frame.north east);
%                 } 
overlay middle ={},
overlay last = { %borde l�nea inferior
 \draw[color=colorejercicios,line width=0.2pt] (frame.south west)--([xshift=0pt]frame.south east); 
                } 
#1}
%-
\NewDocumentEnvironment{cajaejercicios}{O{} O{} O{}}{\smallskip\begin{wwejercicios}{#1}{#2}%
 #3}{\end{wwejercicios}\smallskip }
% ejercicios---------------------------------------------------------


% Comandos para paquete answers
% pregunta-soluci�n
\newcommand{\exersol}[2]{
\begin{ejer} 
#1\scantokens{\begin{solu}#2\end{solu}}
\end{ejer}}
% listas \item pregunta-soluci�n
\newcommand{\itemps}[2]{\item #1\scantokens{\begin{solu}#2\end{solu}}}

\newcommand{\bex}{\scantokens{\begin{solu} \end{solu}}\begin{enumerate}[label=\alph*.)]}
\newcommand{\eex}{\end{enumerate}}
%\begin{sol} \end{sol}


%-
\NewDocumentEnvironment{ejercicio}{O{} O{}}{\smallskip\begin{wwejercicio}{#1}%
}{\end{wwejercicio}\smallskip }
% Ejercicio------------------------------------------------------



% -- Soluciones al final del documento----------------------------
\def\soluciones{
\expandafter\ifx\csname Closesolutionfile\endcsname \relax\else
\Closesolutionfile{ans}\fi
}

\def\solucionesCap#1{\section*{Soluciones del Cap\'{\i}tulo #1}\input{ans#1}}
% Fin Listas de Ejercicios-------------------------------------------


% Fin mis entornos---------------------------------------------------------------


%---------------------------------------------------------------------------------
%  C�digo de programas (LaTeX en ese caso)
%---------------------------------------------------------------------------------
% Listings
\usepackage{listings}% uso: \lstinline|section|
\lstset{ %
	      language={[LaTeX]TeX}, % lenguaje
	      basicstyle=\bfseries\ttfamily,
	      keywordstyle=\color{blue},
	      commentstyle=\color{brown},	   
	      backgroundcolor=\color{grisamarillo},
	      showstringspaces=false,
	      flexiblecolumns=true,
	      stringstyle=\ttfamily\color{blue},
	      extendedchars=true,
emph={rm,bf,it,sf,sl,sc,tt,gtrdot,lesseqqgtr,Supset,mathbb,gtrless,doteqdot,sqsubset,mathbb,eqslantless,risingdotseq,sqsupset,mathbb,lesssim,fallingdotseq,succcurlyeq,therefore,lessapprox,circeq,preccurlyeq,because,approxeq,triangleq,curlyeqprec,leqq,lessdot,thicksim,curlyeqsucc,geqq,gtreqless,thickapox,precsim,leqslant,gtreqqless,backsim,succsim,geqslant,lll,backsimeq,precapprox,eqslantgtr,ggg,subseteqq,succapprox,gtrsim,lessgtr,supseteqq,vartriangleright,gtrapprox,lesseqgtr,Subset,trianglerighteq,maxint,for,to,do
},
    emphstyle={\color{blue}\textbf}
	      }
\newcommand{\wlatex}{\lstinline}


%---------------------------------------------------------------------------------
%  Listas con Tikz 
%---------------------------------------------------------------------------------
% Puntos Tikz y  Enumerate con  Tikz 
  \newcommand{\tpto}{\tikz \shadedraw [shading=ball] (0,0) circle (.1cm);}
  \newcommand{\ttpto}[1]{\begin{tikzpicture}
  	\node[scale=.5, circle, shade, ball color=blue]  {\color{white}\Large\textbf#1};
  \end{tikzpicture}}
  \newcommand{\ttptov}{\begin{tikzpicture}
  	\node[scale=.5, circle, shade, ball color=green]  {\color{white}\Large\textbf.};
  \end{tikzpicture}}
  \newcommand{\ttptor}{\begin{tikzpicture}
  	\node[scale=.5, circle, shade, ball color=red]  {\color{white}\Large\textbf.};
  \end{tikzpicture}}
  \newcommand{\ptoazul}[1]{\begin{tikzpicture}
  	\node[scale=.5, circle, shade, ball color=blue]  {\color{white}\Large\textbf#1};
  \end{tikzpicture}}
 \newcommand{\ptomb}{\ptoazul$\;$}
 \newcommand{\itempto}{\item[\tpto]}
 \newcommand{\pto}{\tpto}
 \newcommand{\ptom}{\tpto$\;$}
 \newcommand{\ptomv}{\ttptov$\;$}
 \newcommand{\ptomr}{\ttptor$\;$}

 % Listas -- con puntos

 %\usepackage{enumerate}
 \newcommand{\witem}[1]{\item[{\bf #1)}]}
 
 \newcommand*{\itembolasgrises}[1]{%
 \footnotesize\protect\tikz[baseline=-3pt]%
 \protect\node[fill=gray!50,shape=circle,draw,inner sep=1.2pt,line width=0.2mm](n1){#1};}
 \newcommand*{\itembolasazules}[1]{%
 \footnotesize\protect\tikz[baseline=-3pt]%
 \protect\node[scale=.5, circle, shade, ball color=blue]  {\color{white}\Large\bf#1};}
 \newcommand*{\itembolasverdes}[1]{%
 \footnotesize\protect\tikz[baseline=-3pt]%
 \protect\node[scale=.5, circle, shade, ball color=green]  {\color{white}\Large\bf#1};}
 \newcommand*{\itembolasrojas}[1]{%
  \footnotesize\protect\tikz[baseline=-3pt]%
  \protect\node[scale=.5, circle, shade, ball color=red]  {\color{white}\Large\bf#1};}
  
%Comando para listas con bolas	
\newcommand{\beaz}{\begin{enumerate}[label=\itembolasazules{\arabic*}]}
\newcommand{\eeaz}{\end{enumerate}}
% Fin de cosas adicionales -


%-----------------------------------------------------------------------------
% TABLAS CON Tikz
%----------------------------------------------------------------------------- 
\usepackage{array}
\usetikzlibrary{calc,fit,shadows,arrows,positioning}
\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}
%--
%------------------------------------------------------------------------------
% Data Table
%------------------------------------------------------------------------------
\newsavebox{\dataTableContent} % Box
\newenvironment{dataTable}[1] % \new environment
{%
\begin{lrbox}{\dataTableContent}%
\begin{tabular}{#1}}%
%
{%
\end{tabular}
\end{lrbox}
\begin{tikzpicture}
\node [inner xsep=0pt] (tbl){\usebox{\dataTableContent}};
\begin{pgfonlayer}{background}
% table
\draw[rounded corners=1pt,top color=gray!1,bottom color=gray!30,draw=black]
(tbl.north east) rectangle (tbl.south west);
% top line
\draw[rounded corners=1pt,top color=gray!10!black,bottom color=gray!50!black,draw=black]%
($(tbl.north west)$) rectangle ($(tbl.north east)-(0,1.5\baselineskip)$);
% bottom rule
\draw[rounded corners=0.25pt,fill=gray,draw=black]%
(tbl.south west) rectangle ($(tbl.south east)+(0,0.05)$);
\end{pgfonlayer}
\end{tikzpicture}}
% --
 
 
 
%----------------------------------------------------------------------------- 
%- Modoficaci�n de chapter para que abra y cierre archivos ans----------------
%-----------------------------------------------------------------------------

%-------------------------------------------------------------------------------
%- Modoficaci�n de chapter para que abra y cierre archivos ans del paquete answers                                   
\newcount\ansj % contador de listas ans i
\ansj=\thechapter
%           % -- Infiltrar \chapter --------------------------------------------
\makeatletter
\let\stdchapter\chapter % \stdchapter guarda la def original de \chapter
\renewcommand*\chapter{ % -- Infiltrar: abrir y cerrar archivos ans j---
\expandafter\ifx\csname Closesolutionfile\endcsname \relax\else
\Closesolutionfile{ans}\fi
\expandafter\ifx\csname Opensolutionfile\endcsname \relax\else
\Opensolutionfile{ans}[ans\number\ansj]\advance\ansj by 1\fi
                        %------------------------------------------------------
                        % Volver a la def original de \chapter
\@ifstar{\starchapter}{\@dblarg\nostarchapter}}
\newcommand*\starchapter[1]{\stdchapter*{#1}}
\def\nostarchapter[#1]#2{\stdchapter[{#1}]{#2}}
\makeatother
 % -- -------------------------------------------------------------------------
 

 
 
%----------------------------------------------------------------------------------------
% Comandos del libro
%----------------------------------------------------------------------------------------

%----------------------------------------------------------------------------------------








